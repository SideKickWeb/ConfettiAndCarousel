import{u as B,_ as V,a as z}from"./BvGU_pER.js";import{_ as q}from"./CtFe8zgF.js";import{u as D}from"./CB8XxEi3.js";import{u as I}from"./BY4aLptK.js";import{_ as O,j as p,r as x,g as R,c as e,b as v,a as t,n as P,F as m,s as g,q as h,t as i,p as _,A as j,o as a,w as E}from"./DPqVHIb4.js";const M={class:"page-wrapper"},G={class:"content"},H={class:"products-content"},J={class:"content-wrapper"},K={class:"category-filters"},Q=["onClick"],U={key:0,class:"loading-container"},W={key:1,class:"error-container"},X={key:2},Y={class:"product-grid"},Z={class:"product-image"},tt=["src","alt"],ot={key:1,class:"no-image"},st={class:"product-info"},et={class:"price"},at={key:0,class:"category-tag"},nt={class:"description"},rt={key:1,class:"product-features"},lt={key:0,class:"product-actions"},it=["onClick"],ct={class:"product-actions"},dt=["onClick"],ut={key:0,class:"empty-products"},_t={class:"toast-container"},pt={__name:"products",setup(vt){const k=j(),r=D(),A=I(),b=B(),f=p(()=>A.isAuthenticated),l=x(""),c=x([]),N=p(()=>(console.log("Available categories:",r.categories),r.categories||[])),y=p(()=>l.value?r.products.filter(n=>n.categoryId===l.value||n.category===l.value):r.products),w=n=>parseFloat(n||0).toFixed(2),C=async()=>{console.log("Loading products from Prisma database via store..."),await r.fetchProducts(),console.log("Products loaded:",r.products.length),console.log("Categories loaded:",r.categories.length)},S=n=>{if(!f.value){k.push("/login");return}k.push({path:"/booking",query:{product:n.id}})},$=n=>{b.addToCart(n),F(`${n.name} added to your cart`)},F=n=>{const s={message:n};c.value.push(s),setTimeout(()=>{const d=c.value.indexOf(s);d!==-1&&c.value.splice(d,1)},3e3)};return R(async()=>{b.loadFromLocalStorage(),await C()}),(n,s)=>{const d=V,T=q,L=z;return a(),e("div",M,[v(d),t("main",G,[s[6]||(s[6]=t("div",{class:"products-header"},[t("div",{class:"header-content"},[t("h1",null,"Our Products"),t("p",null,"Discover our range of premium event decoration products")])],-1)),t("div",H,[t("div",J,[t("div",K,[t("button",{onClick:s[0]||(s[0]=o=>l.value=""),class:P(["filter-btn",l.value?"":"active"])}," All Products ",2),(a(!0),e(m,null,g(N.value,o=>(a(),e("button",{key:o.value,onClick:u=>l.value=o.value,class:P(["filter-btn",l.value===o.value?"active":""])},i(o.label||"Category"),11,Q))),128))]),h(r).loading?(a(),e("div",U,s[2]||(s[2]=[t("span",{class:"loading-spinner"},null,-1),t("p",null,"Loading products...",-1)]))):h(r).error?(a(),e("div",W,[t("p",null,i(h(r).error),1),t("button",{onClick:C,class:"retry-button"},"Retry")])):(a(),e("div",X,[t("div",Y,[(a(!0),e(m,null,g(y.value,o=>(a(),e("div",{key:o.id,class:"product-card"},[v(T,{to:`/product/${o.id}`,class:"product-link"},{default:E(()=>[t("div",Z,[o.image?(a(),e("img",{key:0,src:o.image,alt:o.name},null,8,tt)):(a(),e("div",ot,s[3]||(s[3]=[t("span",null,"No image available",-1)])))]),t("div",st,[t("h3",null,i(o.name),1),t("span",et,"£"+i(w(o.price)),1),o.categoryName?(a(),e("p",at,i(o.categoryName),1)):_("",!0),t("p",nt,i(o.description),1),o.customizable?(a(),e("div",rt,s[4]||(s[4]=[t("span",{class:"feature-badge"},"Customizable",-1)]))):_("",!0)])]),_:2},1032,["to"]),f.value?(a(),e("div",lt,[t("button",{onClick:u=>S(o),class:"book-button"}," Add to Booking ",8,it)])):_("",!0),t("div",ct,[t("button",{onClick:u=>$(o),class:"cart-button"}," Add to Cart ",8,dt)])]))),128))]),y.value.length===0?(a(),e("div",ut,[s[5]||(s[5]=t("p",null,"No products available in this category.",-1)),t("button",{onClick:s[1]||(s[1]=o=>l.value=""),class:"retry-button"},"View All Products")])):_("",!0)]))])])]),t("div",_t,[(a(!0),e(m,null,g(c.value,(o,u)=>(a(),e("div",{key:u,class:"toast"},[s[7]||(s[7]=t("span",{class:"toast-icon"},"✓",-1)),t("span",null,i(o.message),1)]))),128))]),v(L)])}}},ft=O(pt,[["__scopeId","data-v-722b5160"]]);export{ft as default};
