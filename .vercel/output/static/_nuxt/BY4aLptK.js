import{B as a}from"./DPqVHIb4.js";const i=a("auth",{state:()=>({user:null,loading:!1,error:null}),getters:{isAuthenticated:r=>!!r.user,isAdmin:r=>{var e;return((e=r.user)==null?void 0:e.role)==="admin"||!1},firstName:r=>{var e;return((e=r.user)==null?void 0:e.firstName)||""},lastName:r=>{var e;return((e=r.user)==null?void 0:e.lastName)||""},fullName:r=>r.user?`${r.user.firstName} ${r.user.lastName}`:""},actions:{async fetchUser(){if(this.user)return this.user;this.loading=!0,this.error=null;try{const r=await fetch("/api/auth/me");if(!r.ok){if(r.status!==401){const t=await r.json();this.error=t.message||"Failed to fetch user"}return this.user=null,null}const e=await r.json();return this.user=e,e}catch(r){return console.error("Error fetching user:",r),this.error="An unexpected error occurred",this.user=null,null}finally{this.loading=!1}},async login(r,e){this.loading=!0,this.error=null;try{const t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:e})});if(!t.ok){const o=await t.json();return this.error=o.message||"Login failed",!1}const s=await t.json();return this.user=s,!0}catch(t){return console.error("Login error:",t),this.error="An unexpected error occurred",!1}finally{this.loading=!1}},async register(r){this.loading=!0,this.error=null;try{const e=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const s=await e.json();return this.error=s.message||"Registration failed",!1}const t=await e.json();return this.user=t,!0}catch(e){return console.error("Registration error:",e),this.error="An unexpected error occurred",!1}finally{this.loading=!1}},async logout(){this.loading=!0;try{const r=await fetch("/api/auth/logout",{method:"POST"});if(!r.ok){const e=await r.json();return this.error=e.message||"Logout failed",!1}return this.user=null,!0}catch(r){return console.error("Logout error:",r),this.error="An unexpected error occurred",!1}finally{this.loading=!1}},clearError(){this.error=null}}});export{i as u};
